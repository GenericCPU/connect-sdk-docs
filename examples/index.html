<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta charset="utf-8">
  <title>Examples</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="generator" content="Hugo 0.68.3" />
  
  <!-- ** CSS Plugins Needed for the Project ** -->
  
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://docs.handcash.dev/plugins/bootstrap/bootstrap.min.css">

  <!-- themefy-icon -->
  <link rel="stylesheet" href="https://docs.handcash.dev/plugins/themify-icons/themify-icons.css">

  <!--Favicon-->
  <link rel="icon" href="https://i.ibb.co/23X7r7j/logo.png" type="image/x-icon">

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap" rel="stylesheet">
  <style>
  :root{
    --primary-color:#35469C;
    --body-color:#f5f5f5;
    --text-color:#57697a;
    --text-color-dark:#193148;
    --white-color:#f5f5f5;
    --light-color:#f8f9fa;
    --font-family:Roboto;
  }
  </style>
  <link rel="stylesheet" type="text/css" href="https://docs.handcash.dev/css/nav-links.css" />


<!-- Main Stylesheet -->

<link href="https://docs.handcash.dev/css/style.min.css" rel="stylesheet" media="screen"/>
  
<!-- ** JS Plugins Needed for the Project ** -->

<!-- jquiry -->
<script src="https://docs.handcash.dev/plugins/jquery/jquery-1.12.4.js"></script>

<!-- jquary ui -->
<script src="https://docs.handcash.dev/plugins/jquery/jquery-ui.js"></script>

<!-- Bootstrap JS -->
<script src="https://docs.handcash.dev/plugins/bootstrap/bootstrap.min.js"></script>

<!-- match-height JS -->
<script src="https://docs.handcash.dev/plugins/match-height/jquery.matchHeight-min.js"></script>


  

  <!-- create /layouts/partials/overrides/header.html in your own theme or root directory to add your custom content here -->


</head>

  
  <body>
    
    <!-- header -->
    <header class="shadow-bottom sticky-top bg-white">
      <nav class="navbar navbar-expand-md navbar-light">
  <div class="container">
    <a class="navbar-brand px-2" href="/">
      
      
      
      
      <img class="img-fluid" height="40" src="https://docs.handcash.dev/images/connect_logo_text.png" alt="Connect Docs">
      
      
    </a>
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="https://dashboard.handcash.dev">Developer login</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="https://docs.handcash.dev/contact">contact</a>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            docs
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="https://docs.handcash.dev/installation">Installation</a>
            
            <a class="dropdown-item" href="https://docs.handcash.dev/authorization">Authorization</a>
            
            <a class="dropdown-item" href="https://docs.handcash.dev/user-profile">User Profile</a>
            
            <a class="dropdown-item" href="https://docs.handcash.dev/payments">Payments</a>
            
            <a class="dropdown-item" href="https://docs.handcash.dev/encryption">Encryption</a>
            
            <a class="dropdown-item" href="https://docs.handcash.dev/examples">Examples</a>
            
          </div>
        </li>
        
        
      </ul>
      
    </div>
  </div>
</nav>

    </header>
    <!-- /header -->
    
    

<!-- details page -->
<section class="single section-sm pb-0">
  <div class="container">
    <div class="row">
      
      
      </div>
      <div class="col-lg-10 center">
        <div class="p-lg-5 p-4 bg-white">
          
          <div class='parent sticky'>
            <div class='child inline-block-child-top'>
              <a href="/">
                <img src="https://i.ibb.co/f0NdNKr/arrow-left-circle.png">
              </a>
            </div>
            <div class='child inline-block-child-bottom'>
              <h2 class="mb-5">Examples</h2>
            </div>
          </div>
          
          <div class="content"><h4 id="wrench-app">Wrench App</h4>
<p>Wrench App is the official sample app for HandCash Connect. It demonstrates each function of the SDK. All code can be found in the <a href="https://github.com/HandCash/WrenchApp">Github Page</a>, and specific code implementations are provided below.</p>
</br>
<p>Wrench app is live! So you can connect your handcash account and try it out here:</p>
</br>
<center>
  <head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="css/styles.css">
</head>

<body>
	<a href="https://app.handcash.io/#/authorizeApp?appId=6048eb84df06d20c6308669e">
		<div id="connectButton" app-id="123-456">Connect to WrenchApp</div>
		<script type="text/javascript" src="js/wrench_button.js"></script>
	</a>
</body>
</center>
</br>
<h4 id="code-examples">Code Examples</h4>


<div class="notices note" ><p>The goal of these examples are to highlight how the SDK is used inside WrenchApp. There are models, views, and routers inside the express server which I am not showing here. </br></br> To get a complete view of the implementation please view the full <a href="https://github.com/HandCash/WrenchApp">Source Code</a>.</p></div>

<h4 id="imports-and-helper-functions">Imports and helper functions</h4>
<p>Here are a list of imports and helper functions that I am using throughout these examples.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Imports">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">User</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;../models/user.model&#34;</span>);
<span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">PrivateKey</span>, <span style="color:#a6e22e">PublicKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;bsv&#39;</span>);
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ECIES</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;bsv/ecies&#39;</span>);
<span style="color:#66d9ef">const</span> {<span style="color:#a6e22e">HandCashConnect</span>} <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;@handcash/handcash-connect&#39;</span>);
<span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;dotenv&#39;</span>).<span style="color:#a6e22e">config</span>()
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handCashConnect</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HandCashConnect</span>(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">appId</span>);
</code></pre></div>
</div>

   

<div class="tab-pane" title="Helper functions">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parseHandleArray</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">handlesString</span>) =&gt; <span style="color:#a6e22e">handlesString</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/ /g</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\$/g</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;,&#34;</span>)

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parseHandle</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">handleString</span>) =&gt; <span style="color:#a6e22e">handleString</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/ /g</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\$/g</span>, <span style="color:#e6db74">&#34;&#34;</span>)

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ConvertStringToHex</span>(<span style="color:#a6e22e">str</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arr</span> <span style="color:#f92672">=</span> [];
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
        <span style="color:#a6e22e">arr</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">=</span> (<span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>).<span style="color:#a6e22e">toString</span>(<span style="color:#ae81ff">16</span>)).<span style="color:#a6e22e">slice</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>);
  }
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">arr</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#34;&#34;</span>);
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ConvertHexToString</span>(<span style="color:#a6e22e">str1</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hex</span>  <span style="color:#f92672">=</span> <span style="color:#a6e22e">str1</span>.<span style="color:#a6e22e">toString</span>();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">n</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">hex</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>) {
    <span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> String.<span style="color:#a6e22e">fromCharCode</span>(parseInt(<span style="color:#a6e22e">hex</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#a6e22e">n</span>, <span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">16</span>));
  }
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>;
}
</code></pre></div>
</div>
 </div>
</div>
<h4 id="authentication">Authentication</h4>
<p>For the user to login you will need to supply them with a redirect url for your application, this will bring them to the HandCash app and prompt them to authorize permissions for your app. Once they agree they will be redirected back to your app.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Supply Auth Redirect">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">getLoginLink</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {

  <span style="color:#75715e">// fetch authentication url using the SDK
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">redirectUrl</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getRedirectionUrl</span>();
  
  <span style="color:#75715e">// return page with a login button
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;index&#39;</span>, {
    <span style="color:#a6e22e">redirectUrl</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">redirectUrl</span>,
    <span style="color:#a6e22e">docTitle</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Login&#39;</span>,
    <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/&#39;</span>
  })
};
</code></pre></div>
</div>
 </div>
</div>
<p>When the HandCash app redirects back to your application, it will include an &ldquo;authToken&rdquo; query parameter.</p>
<p>In this case, I am grabbing the user&rsquo;s public profile data, and using that to store the user&rsquo;s authToken into a database.</p>
<p>It is very important to associate any received authToken with the user&rsquo;s HandCash ID.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Save Authentication Token">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">getAuthenticate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {

  <span style="color:#75715e">// create a user upon a new login
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">authToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">authToken</span>;

  <span style="color:#75715e">// get user profile, and save alias to the user 
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">authToken</span>);
  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicProfile</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getCurrentProfile</span>()
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handcashId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">publicProfile</span>.<span style="color:#a6e22e">id</span>

  <span style="color:#75715e">// check if the user exists, if not create a new one
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findOne</span>({<span style="color:#a6e22e">handcashId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">handcashId</span>})
  <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">user</span>){
    <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">User</span>();
    <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">handcashId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">handcashId</span>
  }

  <span style="color:#75715e">// update authToken
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">authToken</span>
  
  <span style="color:#75715e">// save user
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">save</span>();

  <span style="color:#75715e">// generating a jwt
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">accessToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">generateAuthToken</span>();
  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#e6db74">&#39;/auth/dashboard&#39;</span>); 
};
</code></pre></div>
</div>
</div>
</div>
<h4 id="profile">Profile</h4>
<p>In this example I&rsquo;m fetching the user&rsquo;s public and private profile data using their authToken and serving it back to the user.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Display Profile Information">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">getProfile</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {

  <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);
  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicProfile</span>, <span style="color:#a6e22e">privateProfile</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getCurrentProfile</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spendableBalance</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">wallet</span>.<span style="color:#a6e22e">getSpendableBalance</span>()
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">permissions</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getPermissions</span>()
  <span style="color:#75715e">// print it out
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">// display public profile
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;profile&#39;</span>, {
    <span style="color:#a6e22e">publicProfile</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">publicProfile</span>,
    <span style="color:#a6e22e">privateProfile</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">privateProfile</span>,
    <span style="color:#a6e22e">spendableBalance</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">spendableBalance</span>,
    <span style="color:#a6e22e">permissions</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">permissions</span>,
    <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/profile&#39;</span>
  }) 
}
</code></pre></div>
</div>
</div>
</div>
<h4 id="friends">Friends</h4>
<p>Here I fetch the user&rsquo;s friends list and return it back to them for viewing.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Display Friends List">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">getFriends</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {

  <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">friends</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getFriends</span>()

  <span style="color:#75715e">// print it out
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">friends</span>)

  <span style="color:#75715e">// display public profile
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;friends&#39;</span>, {
    <span style="color:#a6e22e">friends</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">friends</span>,
    <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/friends&#39;</span>
  }) 
}
</code></pre></div>
</div>
</div>
</div>
<h4 id="payment">Payment</h4>
<p>This function sends a simple payment, transaction parameters are received by my server via POST, and that request is resolved by this function.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Simple Payment">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">sendTransaction</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {

    <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);

    <span style="color:#75715e">// define parameters 
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handle</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseHandle</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">handle</span>)
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">amount</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">amount</span>)
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">note</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">note</span>
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">currencyCode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DUR&#39;</span>

    <span style="color:#75715e">// construct the payment
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">paymentParameters</span> <span style="color:#f92672">=</span> {
        <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">note</span>,
        <span style="color:#a6e22e">payments</span><span style="color:#f92672">:</span>
        [
            {
            <span style="color:#a6e22e">destination</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">handle</span>,
            <span style="color:#a6e22e">currencyCode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">currencyCode</span>,
            <span style="color:#a6e22e">sendAmount</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">amount</span>,
            },
        ],
    };

    <span style="color:#75715e">// make the payment
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payment</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">wallet</span>.<span style="color:#a6e22e">pay</span>(<span style="color:#a6e22e">paymentParameters</span>).<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">err</span> =&gt; {<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>)})
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">payment</span>)

    <span style="color:#75715e">// display public profile with the recent transaction
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#e6db74">&#34;/auth/get-transaction?txid=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">payment</span>.<span style="color:#a6e22e">transactionId</span>)
}
</code></pre></div>
</div>
</div>
</div>
<h4 id="multipayment">MultiPayment</h4>
<p>Here is a second payment example, this time, I am sending a single transaction to multiple recipients.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="MultiParty Payment">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">sendMultisendTransaction</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;here&#34;</span>)
  <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);

  <span style="color:#75715e">// define parameters 
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseHandleArray</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">handles</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">amount</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">amount</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">note</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">note</span>
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">currencyCode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DUR&#39;</span>

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payments</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">handles</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">handle</span> =&gt; {<span style="color:#66d9ef">return</span> {
    <span style="color:#a6e22e">destination</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">handle</span>,
    <span style="color:#a6e22e">currencyCode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">currencyCode</span>,
    <span style="color:#a6e22e">sendAmount</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">amount</span>
  }})

  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">payments</span>)
  <span style="color:#75715e">// configure the payment
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">paymentParameters</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">note</span>,
    <span style="color:#a6e22e">payments</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">payments</span>
  };

  <span style="color:#75715e">// make the payment
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payment</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">wallet</span>.<span style="color:#a6e22e">pay</span>(<span style="color:#a6e22e">paymentParameters</span>)
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">payment</span>)

  <span style="color:#75715e">// display public profile with the recent transaction
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#e6db74">&#34;/auth/get-transaction?txid=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">payment</span>.<span style="color:#a6e22e">transactionId</span>)
}
</code></pre></div>
</div>
</div>
</div>
<h4 id="data">Data</h4>
<p>Here is an example of attaching data to a transaction. In this case, I am converting the data into a HEX format and adding it to the payment parameters. This data is stored publically for anyone to see. Generally you&rsquo;d use this feature for transparency and auditability purposes.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Data Attachment">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// sends a transaction on behalf of the user
</span><span style="color:#75715e"></span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">sendDataTransaction</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);
  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicProfile</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getCurrentProfile</span>()

  <span style="color:#75715e">// define parameters 
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handle</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">publicProfile</span>.<span style="color:#a6e22e">handle</span>
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">amount</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">note</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Posting data to the chain&#39;</span>
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ConvertStringToHex</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">text</span>)
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>)
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">currencyCode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DUR&#39;</span>

  <span style="color:#75715e">// construct the payment
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">paymentParameters</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">note</span>,
    <span style="color:#a6e22e">payments</span><span style="color:#f92672">:</span>
      [
        {
          <span style="color:#a6e22e">destination</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">handle</span>,
          <span style="color:#a6e22e">currencyCode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">currencyCode</span>,
          <span style="color:#a6e22e">sendAmount</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">amount</span>,
        },
      ],

    <span style="color:#75715e">//attachment: { format: &#39;base64&#39;, value: &#39;ABEiM0RVZneImQCqu8zd7v8=&#39; },
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">attachment</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;hex&#39;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span> },
  };

  <span style="color:#75715e">// make the payment
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payment</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">wallet</span>.<span style="color:#a6e22e">pay</span>(<span style="color:#a6e22e">paymentParameters</span>).<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">err</span> =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>))

  <span style="color:#75715e">// display public profile with the recent transaction
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">redirect</span>(<span style="color:#e6db74">&#34;/auth/get-transaction?txid=&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">payment</span>.<span style="color:#a6e22e">transactionId</span>)
}

</code></pre></div>
</div>
</div>
</div>
<h4 id="encrypt">Encrypt</h4>
<p>Here I am simply using the SDK to fetch an encryption keypair each user has one unique keypair assigned to each application they are connected to. Once obtained I use the keypair with an external library to encrypt and decrypt some data.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Encrypt Data">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">postEncrypt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {

  <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);

  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">publicKey</span>, <span style="color:#a6e22e">privateKey</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">profile</span>.<span style="color:#a6e22e">getEncryptionKeypair</span>();
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">publicKey</span>);

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ecPrivateKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">PrivateKey</span>.<span style="color:#a6e22e">fromWIF</span>(<span style="color:#a6e22e">privateKey</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ecPublicKey</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">PublicKey</span>.<span style="color:#a6e22e">fromString</span>(<span style="color:#a6e22e">publicKey</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">plainText</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">encryptText</span>;

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptedBuffer</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ECIES</span>().<span style="color:#a6e22e">publicKey</span>(<span style="color:#a6e22e">ecPublicKey</span>).<span style="color:#a6e22e">encrypt</span>(<span style="color:#a6e22e">plainText</span>);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">encryptedBuffer</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;base64&#39;</span>));

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decryptedBuffer</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ECIES</span>().<span style="color:#a6e22e">privateKey</span>(<span style="color:#a6e22e">ecPrivateKey</span>).<span style="color:#a6e22e">decrypt</span>(<span style="color:#a6e22e">encryptedBuffer</span>);
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">decryptedBuffer</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>));

  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">assert</span>(<span style="color:#a6e22e">decryptedBuffer</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;utf8&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#a6e22e">plainText</span>);

  <span style="color:#75715e">// display public profile with the recent transaction
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;encryption&#39;</span>, {
    <span style="color:#a6e22e">encryptionDetails</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">ecPrivateKey</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ecPrivateKey</span>,
      <span style="color:#a6e22e">ecPublicKey</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ecPublicKey</span>,
      <span style="color:#a6e22e">plainText</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">plainText</span>,
      <span style="color:#a6e22e">encryptedBuffer</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">encryptedBuffer</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>),
      <span style="color:#a6e22e">decryptedBuffer</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">decryptedBuffer</span>
    },
    <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/encryption&#39;</span>
  })
}

</code></pre></div>
</div>
</div>
</div>
<h4 id="fetchtx">FetchTX</h4>
<p>Here I am fetching transaction data from a previous transaction performed by the user.</p>


<div class="code-tabs">
  <ul class="nav nav-tabs"></ul>
  <div class="tab-content">
   

<div class="tab-pane" title="Fetch Payment">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// sends a transaction on behalf of the user
</span><span style="color:#75715e"></span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">getTransaction</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {

  <span style="color:#75715e">// fetch the authenticated user and their profile
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findById</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">_id</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">account</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">handCashConnect</span>.<span style="color:#a6e22e">getAccountFromAuthToken</span>(<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">connectAuthToken</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">paymentResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">account</span>.<span style="color:#a6e22e">wallet</span>.<span style="color:#a6e22e">getPayment</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">txid</span>)
 

  <span style="color:#75715e">// Converting hex into a human readable format for my view
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">paymentResult</span>.<span style="color:#a6e22e">attachments</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">paymentResult</span>.<span style="color:#a6e22e">attachments</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">attachment</span> =&gt; {
    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">attachment</span>.<span style="color:#a6e22e">format</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;hex&#39;</span>) 
      <span style="color:#a6e22e">attachment</span>.<span style="color:#a6e22e">hexValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ConvertHexToString</span>(<span style="color:#a6e22e">attachment</span>.<span style="color:#a6e22e">value</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">attachment</span>
  })
  
  <span style="color:#75715e">// display public profile with the recent transaction
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;transaction&#39;</span>, {
    <span style="color:#a6e22e">tx</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">paymentResult</span>,
    <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/transaction&#39;</span>
  })
}
</code></pre></div>
</div>
</div>
</div>
</div>
          
          <hr/>
          <nav class="pagination mt-3">
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            

            
            <a class="nav nav-prev" href="https://docs.handcash.dev/data-signing/"><i class="ti-arrow-left mr-2"></i> <span class="d-none d-md-block">Data Signing</span></a>
            
            
            <a class="nav nav-next" href="https://docs.handcash.dev/errors/"> <span class="d-none d-md-block">Errors</span><i class="ti-arrow-right ml-2"></i></a>
            
          </nav>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- /details page -->





    <!-- footer -->
<footer class="section pb-4">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8 text-md-left text-center">
       <p class="mb-md-0 mb-4"></p>
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://twitter.com/handcashconnect"><i class="ti-twitter-alt"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Main Script -->

<script src="https://docs.handcash.dev/js/script.min.js"></script>
  </body>

</html>